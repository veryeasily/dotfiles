#!/bin/sh

input=$(readlink -f "$1");
directory=$(dirname "$input")
output=$(basename "${input%%.*}");
ffmpeg \
    -i "$input" \
    -pix_fmt rgb8 \
    "${output}.gif" \
    && gifsicle \
        --optimize=3 \
        --output "${directory}/${output}-optimized.gif" \
        --resize-height 600 \
        "${output}.gif"
